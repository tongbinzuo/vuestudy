webpackJsonp([37],{"5DqN":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),o=a.n(s),n=a("exGp"),i=a.n(n),r=a("W4IK"),c={props:{bid:{type:String,default:""},showRewardDialog:{type:Boolean,default:!1}},data:function(){return{showDialog:!1,curTabIndex:0,curSelectRewardItem:"",curSelectVoteItem:"",curRewardSelectIndex:0,curRewardVoteSelectIndex:0,rewardItems:[],voteRewardItems:[],balance:0,bookMonthvote:0,monthvote:0}},created:function(){this.fetchRewardItems()},computed:{btnDisplayText:function(){return 0===this.curTabIndex?this.isObjEmpty(this.curSelectRewardItem)?"充值":this.balance>=this.curSelectRewardItem.price?"打赏":"充值":this.monthvote>0?"投一票":this.balance>=this.curSelectVoteItem.price?"打赏":"充值"}},methods:{dismiss:function(){this.$emit("dimiss-reward-dialog")},selectTab:function(t){this.curTabIndex=t},doRewordOrVote:function(){var t=this;return i()(o.a.mark(function e(){var a,s,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLogin()){e.next=3;break}return t.$router.push("/login"),e.abrupt("return");case 3:if(0!==t.curTabIndex){e.next=17;break}if(!t.isObjEmpty(t.curSelectRewardItem)){e.next=7;break}return t.$toast("请选中一个道具"),e.abrupt("return");case 7:if("充值"!==t.btnDisplayText){e.next=11;break}t.$router.push({name:"Recharge"}),e.next=15;break;case 11:return e.next=13,r.a.doReward(t.bid,t.curSelectRewardItem.pid);case 13:(a=e.sent).balance?(t.balance=a.balance,t.bookMonthvote=a.bookMonthvote,t.monthvote=a.monthvote,t.$toast("打赏成功")):t.$toast(a.response.data.localized_message);case 15:e.next=33;break;case 17:if("充值"!==t.btnDisplayText){e.next=21;break}t.$router.push({name:"Recharge"}),e.next=33;break;case 21:if("投一票"!==t.btnDisplayText){e.next=29;break}return e.next=24,r.a.voteForBook(t.bid);case 24:null!=(s=e.sent).monthvote?(t.monthvote=s.monthvote,t.bookMonthvote=t.bookMonthvote+1,t.$toast("投票成功")):(3001==s.response.data.code&&(t.monthvote=0),t.$toast(s.response.data.localized_message)),console.log(s),e.next=33;break;case 29:return e.next=31,r.a.doReward(t.bid,t.curSelectVoteItem.pid);case 31:(n=e.sent).balance?(t.balance=n.balance,t.bookMonthvote=n.bookMonthvote,t.monthvote=n.monthvote,t.$toast("打赏成功")):t.$toast(n.response.data.localized_message);case 33:case"end":return e.stop()}},e,t)}))()},selectReward:function(t,e){this.curRewardSelectIndex=t,this.curSelectRewardItem=e},selectVoteReward:function(t,e){this.curRewardVoteSelectIndex=t,this.curSelectVoteItem=e},fetchRewardItems:function(){var t=this;return i()(o.a.mark(function e(){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.bid){e.next=5;break}return e.next=3,r.a.getRewardItems(t.bid);case 3:(a=e.sent)&&(t.isObjEmpty(a.tipProp)||(t.curSelectRewardItem=a.tipProp[0]),t.isObjEmpty(a.superTipProp)||(t.curSelectVoteItem=a.superTipProp[0]),t.voteRewardItems=a.superTipProp,t.bookMonthvote=a.bookMonthvote,t.rewardItems=a.tipProp,t.balance=a.balance,t.monthvote=a.monthvote);case 5:case"end":return e.stop()}},e,t)}))()}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showRewardDialog?s("div",{staticClass:"dialog-mask",on:{click:t.dismiss}},[s("div",{staticClass:"reward-dialog"},[0===t.curTabIndex?[s("div",{staticClass:"reward-item-container"},t._l(t.rewardItems,function(e,o){return s("div",{key:o,staticClass:"reward-item",on:{click:function(a){return a.stopPropagation(),t.selectReward(o,e)}}},[s("div",{staticClass:"icon"},[s("img",{staticClass:"img_wh",attrs:{src:e.icon}})]),t._v(" "),s("p",{staticClass:"item-name f_13"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"item-price c_263036_5 f_12"},[t._v(t._s(e.price)+"充值币")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.curRewardSelectIndex===o,expression:"curRewardSelectIndex === index"}],staticClass:"ic_check"},[s("img",{staticClass:"img_wh",attrs:{src:a("JhBV")}})]),t._v(" "),e.monthvote>0?s("span",{staticClass:"rewad-vote-count f_12"},[t._v("投"+t._s(e.monthvote)+"月票")]):t._e()])}),0),t._v(" "),s("div",{staticClass:"account-balance"},[t._v("\n        余额："),s("span",[t._v(t._s(t.balance)+" ")]),t._v("充值币\n      ")])]:t._e(),t._v(" "),1===t.curTabIndex?[s("div",{staticClass:"month-vote-container"},[t.monthvote>0?s("div",{staticClass:"mont-vote-normal"},[s("p",{staticClass:"title"},[t._v("已获得"),s("span",[t._v(t._s(t.bookMonthvote))]),t._v("张月票")]),t._v(" "),s("p",{staticClass:"desc"},[t._v("投月票提升本书排名～")]),t._v(" "),t._m(0),t._v(" "),s("p",{staticClass:"extra"},[t._v("本月剩余："),s("span",[t._v(t._s(t.monthvote))]),t._v("张")])]):s("div",{staticClass:"month-vote-empty"},[s("p",{staticClass:"title"},[t._v("已获得"),s("span",[t._v(t._s(t.bookMonthvote))]),t._v("张月票")]),t._v(" "),s("p",{staticClass:"desc"},[t._v("本月剩余0张，打赏自动送月票呦～")]),t._v(" "),s("div",{staticClass:"vote-reward-item-container"},t._l(t.voteRewardItems,function(e,o){return s("div",{key:o,staticClass:"reward-item",on:{click:function(a){return a.stopPropagation(),t.selectVoteReward(o,e)}}},[s("div",{staticClass:"icon"},[s("img",{staticClass:"img_wh",attrs:{src:e.icon}})]),t._v(" "),s("p",{staticClass:"item-name f_13"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"item-price c_263036_5 f_12"},[t._v(t._s(e.price)+"充值币")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.curRewardVoteSelectIndex===o,expression:"curRewardVoteSelectIndex === index"}],staticClass:"ic_check"},[s("img",{staticClass:"img_wh",attrs:{src:a("JhBV")}})]),t._v(" "),e.monthvote>0?s("span",{staticClass:"rewad-vote-count f_12"},[t._v("投"+t._s(e.monthvote)+"月票")]):t._e()])}),0)])])]:t._e(),t._v(" "),s("div",{staticClass:"bottom-panel"},[s("div",{staticClass:"left-switch"},[s("p",{staticClass:"item-normal f_14",class:{"item-active":0===t.curTabIndex},on:{click:function(e){return e.stopPropagation(),t.selectTab(0)}}},[t._v("打赏")]),t._v(" "),s("p",{staticClass:"item-normal f_14",class:{"item-active":1===t.curTabIndex},on:{click:function(e){return e.stopPropagation(),t.selectTab(1)}}},[t._v("月票")])]),t._v(" "),s("div",{staticClass:"right-btn",on:{click:function(e){return e.stopPropagation(),t.doRewordOrVote(e)}}},[s("p",[t._v(t._s(t.btnDisplayText))])])])],2)]):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ic_reward"},[e("img",{staticClass:"img_wh",attrs:{src:a("t5nP")}})])}]};var v=a("VU/8")(c,l,!1,function(t){a("eGX+")},"data-v-599b1e88",null);e.default=v.exports},JhBV:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAMAAADW3miqAAAAe1BMVEUAAABNjO9Vk/BNjO9OjO5OjO5OjO9OjO9Pju9Oj/JVqv9QjO9NjO9Oi+9Oje5Ni+7////6/P72+f6fwfWTufSFsPN7qfLy9v2jw/Zyo/FclO9Qje7r8v3b5/vG2vm80/iuyveKs/RonfBimfDj7fzO3/qwy/dtoPFWkO4epF7iAAAAD3RSTlMAvxDY88W6kFE7A12ioVxRuaIdAAABEklEQVQ4y42U57KDIBCFAVti22NLjOnJbe//hHcSEYWg+P1hnTmDh21sisgz7vm+x7NcMDsbThP4xiLZBmQQbA1JHJGFKNbMhGQlFBONRzN4ShWHNEs4/DGiBSL5Llqkf2NAiwTvHNIMnTxfWeVk5fiNu8w9Y2JGcwEqGQuWkJUrcP6TccJSsnEDvjqSpHZLFXB6qi/Ohor8nisaqIH9Y1Ib5suoHY02BcoDjfhK9NwD9TvaFSh2pIlUAxxKFE1/otFbQRofb3ioGyfGM1LcgbI5AS3pZFoya7z4IYNcL0sL4EomwijwDZcjGfCPVunog83KpnO37+pBcI+UezhXj7l7YbhXj3uJ2RFJ2q/DNNHM/AMOQT0PHu8SJgAAAABJRU5ErkJggg=="},"eGX+":function(t,e){},t5nP:function(t,e,a){t.exports=a.p+"static/img/ic_reward_ticket.4c10328.png"}});